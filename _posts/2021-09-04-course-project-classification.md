---
toc: true
layout: post
comments: true
description: Курсовой проект "База данных на MySQL для рынка финансовых инструментов"
categories: [course project, mysql, geekbrain]
title: Course project "MySQL database for the financial instruments market"
---

Согласно представленному заданию мне было необходимо придумать тему и по ней создать базу данных.Вот общее описание проекта:

**Требования к курсовому проекту:**
1. Составить общее текстовое описание БД и решаемых ею задач;
2. минимальное количество таблиц - 10;
3. скрипты создания структуры БД (с первичными ключами, индексами, внешними ключами);
4. создать ERDiagram для БД;
5. скрипты наполнения БД данными;
6. скрипты характерных выборок (включающие группировки, JOIN'ы, вложенные таблицы);
7. представления (минимум 2);
8. хранимые процедуры / триггеры;

*Примеры: описать модель хранения данных популярного веб-сайта: кинопоиск, booking.com, wikipedia, интернет-магазин, geekbrains, госуслуги...*

За основу я взял [статью](https://vertabelo.com/blog/a-data-model-for-trading-stocks-funds-and-cryptocurrencies/), размещенную на иностранном источнике. В ней показана основная схема. Осталось только ее перевести в SQL. Прежде перевод теории.

Торговля криптовалютами, покупка акций и тому подобное в наши дни чрезвычайно популярны, так как это воспринимается как легкая прибыль. В настоящее время цены растут, но мы не можем знать, когда это изменится. С другой стороны, мы знаем, что в какой-то момент это произойдет. Но мы здесь не для того, чтобы делать финансовые прогнозы. Вместо этого мы поговорим о модели данных, которую можно использовать для поддержки торговли криптовалютами и финансовыми инструментами, такими как акции или акции фондов.

### Что Вам нужно знать О Торговле Валютами и Акциями

Технологические усовершенствования за последние несколько десятилетий оказали значительное влияние на торговлю. В настоящее время существует множество онлайн-торговых платформ, которые вы можете использовать. Большая часть сегодняшней торговли осуществляется виртуально – вы можете увидеть бумажные акции в музеях, но вряд ли вы увидите акции, которые вы покупаете в бумажной форме. И вам не нужно паковать чемоданы и отправляться на Уолл-стрит или любую другую фондовую биржу, чтобы совершить сделку. Не выходя из своего компьютера или мобильного устройства, вы можете покупать или продавать производные финансовые инструменты (такие как облигации, акции или товары).

Большинство сделок (продажа производных финансовых инструментов) следуют тем же правилам. Есть продавцы и покупатели. Если они договорятся о цене, сделка состоится. После сделки цена этого производного финансового инструмента будет пересчитана, и процесс продолжится с новыми трейдерами. Акции и другие производные финансовые инструменты работают точно так же.

Что такое криптовалюта? Вы, наверное, слышали о биткойне и других криптовалютах. Но что это такое? Криптовалюты похожи на виртуальные валюты, но они не привязаны к валютам реального мира (таким как евро или доллары). Вместо этого пользователи могут торговать криптовалютами между собой, как токенами. Затем они могут договориться о продаже, которая превратит их токены в реальные деньги. Эти продажи функционируют точно так же, как описанные выше сделки с акциями и акциями.

Эта тема сложна, и в нашей модели может быть много деталей (например, записи документов и транзакций). Я собираюсь сделать это просто; я не буду реализовывать какую-либо автоматическую торговлю или какие-либо формулы для создания новых цен после торгового события.

Перейдем к коду. Согласно статье база состоит из трех блоков:

* CURRENCIES
* TRADERS
* ITEMS

Теперь напишем код ля каждого блока:

**CURRENCIES**

~~~~sql
CREATE DATABASE IF NOT EXISTS coursework_portfolio;
USE coursework_portfolio;
~~~~

Сначало создаю страну из которой осуществляется торговля

~~~~sql
DROP TABLE IF EXISTS country;

CREATE TABLE country(
	id SERIAL PRIMARY KEY,
	country VARCHAR(128)
) COMMENT = 'Страна из которой осуществляется торговля';
~~~~

Валюту которую использует пользователь для торговли

~~~~sql
DROP TABLE IF EXISTS currency_used;

CREATE TABLE currency_used(
	id SERIAL PRIMARY KEY,
	country_id BIGINT UNSIGNED NOT NULL COMMENT 'Ключ на другую таблицу',
	currency_id INT UNSIGNED COMMENT 'Ключ на другую таблицу',
	data_from DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'Дата начала использования валюты',
	data_to DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'Дата окончания использования валюты. Если NULL, то валюта до сих пор используется'
) COMMENT = 'Валюта использованная для покупки';

DESC currency_used ;
~~~~

Хранятся текущие и исторические курсы между валютными парами.

~~~~sql
DROP TABLE IF EXISTS currency_rate;

CREATE TABLE currency_rate(
	id SERIAL PRIMARY KEY,
	currency_id INT UNSIGNED COMMENT 'Ключ на другую таблицу',
	base_currency_id INT UNSIGNED COMMENT 'Ключ на другую таблицу',
	rate DECIMAL(16,6) NOT NULL DEFAULT 0 COMMENT 'Курс валюты',
	ts DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'Время в которое данный курс был зафиксирован'
) COMMENT = 'Курс валюты';
~~~~

Хранить все валюты, которые мы когда-либо использовали для торговли.

~~~~sql
DROP TABLE IF EXISTS currency;

CREATE TABLE currency(
	id INT UNSIGNED PRIMARY KEY,
	code VARCHAR(8) NOT NULL UNIQUE COMMENT 'Код используемый для уникального обозначения валюты',
	name VARCHAR(128) NOT NULL UNIQUE COMMENT 'Уникальное название этой валюты',
	is_active BOOL DEFAULT FALSE COMMENT 'Если валюта в настоящее время активна в нашей системе',
	is_base_currency BOOL DEFAULT FALSE COMMENT 'Если эта валюта является базовой валютой нашей системы.'
) COMMENT = 'Курс валюты';
~~~~
