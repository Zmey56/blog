<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Graduation project “Identification of Internet users” - Comparison of classification algorithms. Programming Assignment | alex.gladkikh.org</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Graduation project “Identification of Internet users” - Comparison of classification algorithms. Programming Assignment" />
<meta name="author" content="Zmey56" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Выпускной проект “Идентификация интернет-пользователей” Week 4" />
<meta property="og:description" content="Выпускной проект “Идентификация интернет-пользователей” Week 4" />
<link rel="canonical" href="https://zmey56.github.io/blog//graduation%20project/machine%20learning/stepik/yandex/english/2019/08/09/project-identification-of-internet-users-week4.html" />
<meta property="og:url" content="https://zmey56.github.io/blog//graduation%20project/machine%20learning/stepik/yandex/english/2019/08/09/project-identification-of-internet-users-week4.html" />
<meta property="og:site_name" content="alex.gladkikh.org" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-09T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://zmey56.github.io/blog//graduation%20project/machine%20learning/stepik/yandex/english/2019/08/09/project-identification-of-internet-users-week4.html","@type":"BlogPosting","headline":"Graduation project “Identification of Internet users” - Comparison of classification algorithms. Programming Assignment","dateModified":"2019-08-09T00:00:00-05:00","datePublished":"2019-08-09T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://zmey56.github.io/blog//graduation%20project/machine%20learning/stepik/yandex/english/2019/08/09/project-identification-of-internet-users-week4.html"},"author":{"@type":"Person","name":"Zmey56"},"description":"Выпускной проект “Идентификация интернет-пользователей” Week 4","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://zmey56.github.io/blog//feed.xml" title="alex.gladkikh.org" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-183752218-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">alex.gladkikh.org</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Graduation project &quot;Identification of Internet users&quot; - Comparison of classification algorithms. Programming Assignment</h1><p class="page-description">Выпускной проект "Идентификация интернет-пользователей" Week 4</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2019-08-09T00:00:00-05:00" itemprop="datePublished">
        Aug 9, 2019
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Zmey56</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      29 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#graduation project">graduation project</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#machine learning">machine learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#stepik">stepik</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#yandex">yandex</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#english">english</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Zmey56/blog/tree/master/_notebooks/2019-08-09-project-identification-of-internet-users-week4.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Zmey56/blog/master?filepath=_notebooks%2F2019-08-09-project-identification-of-internet-users-week4.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Zmey56/blog/blob/master/_notebooks/2019-08-09-project-identification-of-internet-users-week4.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Part-1.-Comparison-of-several-algorithms-in-sessions-of-10-sites">Part 1. Comparison of several algorithms in sessions of 10 sites </a></li>
<li class="toc-entry toc-h2"><a href="#Part-2.-Selection-of-parameters---session-length-and-window-width">Part 2. Selection of parameters - session length and window width </a></li>
<li class="toc-entry toc-h2"><a href="#Part-3.-Identification-of-a-specific-user-and-learning-curves">Part 3. Identification of a specific user and learning curves </a></li>
<li class="toc-entry toc-h2"><a href="#Ways-to-improve">Ways to improve </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-08-09-project-identification-of-internet-users-week4.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Week 4.</strong> Comparison of classification algorithms</p>
<p>Now we will finally approach the training of classification models, compare several algorithms on cross-validation, and figure out which session length parameters (<em>session_length</em> and <em>window_size</em>) are better to use. Also, for the selected algorithm, we will construct validation curves (how the classification quality depends on one of the hyperparameters of the algorithm) and learning curves (how the classification quality depends on the sample size).</p>
<p><strong>4 week plan:</strong></p>
<ul>
<li>Part 1. Comparison of several algorithms in sessions of 10 sites</li>
<li>Part 2. Selection of parameters - session length and window width</li>
<li>Part 3. Identification of a specific user and learning curves</li>
</ul>
<p><strong>In this part of the project, video recordings of the following lectures of the course "Learning from marked data" may be useful:</strong></p>
<ul>
<li><a href="https://www.coursera.org/learn/supervised-learning/lecture/jqLcO/linieinaia-klassifikatsiia">Linear qualification</a></li>
<li><a href="https://www.coursera.org/learn/supervised-learning/lecture/aF79U/sravnieniie-alghoritmov-i-vybor-ghipierparamietrov">Comparison of algorithms and selection of hypermarkets</a></li>
<li><a href="https://www.coursera.org/learn/supervised-learning/lecture/XbHEk/kross-validatsiia-sklearn-cross-validation">Cross-validation. Sklearn.cross_validation</a></li>
<li><a href="https://www.coursera.org/learn/supervised-learning/lecture/EBg9t/linieinyie-modieli-sklearn-linear-model-klassifikatsiia">Linear models. Sklearn.linear_model. Классификация</a></li>
<li>and many others</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#%load_ext watermark</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="c1"># disable any Anaconda warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">'/content/drive'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mounted at /content/drive
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PATH_TO_DATA</span> <span class="o">=</span> <span class="s1">'/content/drive/MyDrive/DATA/Stepik/capstone_user_identification'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-1.-Comparison-of-several-algorithms-in-sessions-of-10-sites">
<a class="anchor" href="#Part-1.-Comparison-of-several-algorithms-in-sessions-of-10-sites" aria-hidden="true"><span class="octicon octicon-link"></span></a>Part 1. Comparison of several algorithms in sessions of 10 sites<a class="anchor-link" href="#Part-1.-Comparison-of-several-algorithms-in-sessions-of-10-sites"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's load the previously serialized objects <em>X_sparse_10 users</em> and <em>y_10 users</em>, corresponding to the training sample for 10 users.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> 
         <span class="s1">'X_sparse_10users.pkl'</span><span class="p">),</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">X_sparse_10users_pkl</span><span class="p">:</span>
    <span class="n">X_sparse_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">X_sparse_10users_pkl</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> 
                       <span class="s1">'y_10users.pkl'</span><span class="p">),</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">y_10users_pkl</span><span class="p">:</span>
    <span class="n">y_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">y_10users_pkl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>There are more than 14 thousand sessions and almost 5 thousand unique visited sites.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_sparse_10users</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(14061, 4913)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's split the sample into 2 parts. On one we will carry out cross-validation, on the second we will evaluate the model trained after cross-validation.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># X_sparse_10users = X_sparse_10users.todense()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sparse_10users</span><span class="p">,</span> <span class="n">y_10users</span><span class="p">,</span> 
                                                      <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                     <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_10users</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's set the type of cross-validation in advance: 3-fold, with mixing, the parameter random_state = 56 - for reproducibility.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Auxiliary function for drawing validation curves after starting GridSearchCV (or RandomizedCV).</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_validation_curves</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">grid_cv_results_</span><span class="p">):</span>
    <span class="n">train_mu</span><span class="p">,</span> <span class="n">train_std</span> <span class="o">=</span> <span class="n">grid_cv_results_</span><span class="p">[</span><span class="s1">'mean_train_score'</span><span class="p">],</span> <span class="n">grid_cv_results_</span><span class="p">[</span><span class="s1">'std_train_score'</span><span class="p">]</span>
    <span class="n">valid_mu</span><span class="p">,</span> <span class="n">valid_std</span> <span class="o">=</span> <span class="n">grid_cv_results_</span><span class="p">[</span><span class="s1">'mean_test_score'</span><span class="p">],</span> <span class="n">grid_cv_results_</span><span class="p">[</span><span class="s1">'std_test_score'</span><span class="p">]</span>
    <span class="n">train_line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">train_mu</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'train'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">)</span>
    <span class="n">valid_line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">valid_mu</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'test'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">train_mu</span> <span class="o">-</span> <span class="n">train_std</span><span class="p">,</span> <span class="n">train_mu</span> <span class="o">+</span> <span class="n">train_std</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                     <span class="n">facecolor</span><span class="o">=</span><span class="n">train_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">valid_mu</span> <span class="o">-</span> <span class="n">valid_std</span><span class="p">,</span> <span class="n">valid_mu</span> <span class="o">+</span> <span class="n">valid_std</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                     <span class="n">facecolor</span><span class="o">=</span><span class="n">valid_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>1. Let's train a 'KNeighborsClassifier' with 100 nearest neighbors (we'll leave the rest of the parameters by default, only 'n_jobs'= -1 for parallelization) and look at the proportion of correct answers on 3-fold cross-validation (for the sake of reproducibility, we use the <code>StratifiedKFold</code> <code>skf' object for this) on the sample</code>(X_train, y_train)<code>and separately on the sample</code>(X_valid, y_valid)`.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">knn_cv_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"CV scores:"</span><span class="p">,</span> <span class="n">knn_cv_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"mean:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">knn_cv_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"std:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">knn_cv_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CV scores: [0.56598598 0.55409936 0.55792683]
mean: 0.5593373897012363
std: 0.004954135909104914
Time elapsed:  3.559767246246338
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"CV scores:"</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"mean:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"std:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CV scores: [0.50817342 0.51351351 0.48435277]
mean: 0.5020132353203838
std: 0.012676699846532288
Time elapsed:  0.5638549327850342
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>Importernt:I had a problem with my code in this place: cross_val_score did not work and gave result <em>NaN</em>  or, if I used the <em>todense</em>, code worked for too long.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 1 </font> Let's calculate the proportion of correct answers for the KNeighborsClassifier on cross-validation and deferred sampling. I'll round each one up to 3 decimal places.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">knn_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"KNN Cross-Validation Score: </span><span class="si">{</span><span class="n">knn_cv_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"KNN Validation Score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">knn_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>KNN Cross-Validation Score: 0.559
KNN Validation Score: 0.584
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>2. Train a random forest (RandomForestClassifier) of 100 trees (for reproducibility random_state=17). Let's look at the OOB score (for which we will immediately set oob_score=True) and the proportion of correct answers in the sample (X_valid, y_valid). For parallelization, set n_jobs= -1.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 2. </font>  Calculate the percentages of correct answers for RandomForestClassifier during Out-of-Bag evaluation and on deferred sampling?</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Score: '</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Score:  0.9759195285511075
Time elapsed:  11.684211492538452
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">oob_score_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7172322698638488
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">clf_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">clf_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7312159279450107
Time elapsed:  0.20986366271972656
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>3. Let's train Logistic Regression with the default parameter C and random_state=17 (for reproducibility). Let's look at the proportion of correct answers on cross-validation (using the scf object created earlier) and on the sample (X_valid, y_valid). For parallelization, set n_jobs= -1.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">LogisticRegressionCV</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logit</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">logit_cv_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">)</span>

<span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">logit_y_pred</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="n">logit_val_score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">logit_y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LogReg Cross-Validation Score: </span><span class="si">{</span><span class="n">logit_cv_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LogReg Validation Score: </span><span class="si">{</span><span class="n">logit_val_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LogReg Cross-Validation Score: 0.761
LogReg Validation Score: 0.777
Time elapsed:  10.484177112579346
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using LogisticRegressionCV, we will select the parameter C for Logistic Regression first in a wide range: 10 values from 1e-4 to 1e2, use logspace from NumPy. Specify the LogisticRegressionCV parameters multi_class='multinomial' and random_state=17. For cross-validation, we use the skf object created earlier. For parallelization, set n_jobs= -1.</p>
<p>At the end, we will draw validation curves for parameter C.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">logit_c_values1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">logit_grid_searcher1</span> <span class="o">=</span> <span class="n">LogisticRegressionCV</span><span class="p">(</span><span class="n">Cs</span><span class="o">=</span><span class="n">logit_c_values1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span>
                                            <span class="n">multi_class</span><span class="o">=</span><span class="s2">"multinomial"</span><span class="p">,</span>
                                            <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">logit_grid_searcher1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Time elapsed:  91.80030512809753
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The average values of the proportion of correct responses to cross-validation for each of the 10 parameters C.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logit_mean_cv_scores1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">logit_grid_searcher1</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">logit_mean_cv_scores1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.31954964, 0.47307397, 0.55202236, 0.64875035, 0.71438846,
       0.75177962, 0.76092382, 0.75848551, 0.749849  , 0.74029823])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will output the best value of the proportion of correct answers on cross-validation and the corresponding value with.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_score1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">logit_mean_cv_scores1</span><span class="p">)</span>
<span class="n">best_C1</span> <span class="o">=</span> <span class="n">logit_grid_searcher1</span><span class="o">.</span><span class="n">Cs_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logit_mean_cv_scores1</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Score: </span><span class="si">{</span><span class="n">best_score1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best C: </span><span class="si">{</span><span class="n">best_C1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Best Score: 0.7609238210638737
Best C: 1.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's draw a graph of the dependence of the proportion of correct answers to cross-validation on `C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">logit_c_values1</span><span class="p">,</span> <span class="n">logit_mean_cv_scores1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Now the same thing, only the values of parameter 'C' are iterated over in the range np.linspace(0.1, 7, 20). Let's draw validation curves again, determine the maximum value of the proportion of correct answers on cross-validation.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">logit_c_values2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">logit_grid_searcher2</span> <span class="o">=</span> <span class="n">LogisticRegressionCV</span><span class="p">(</span><span class="n">Cs</span><span class="o">=</span><span class="n">logit_c_values2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">'multinomial'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">logit_grid_searcher2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Time elapsed:  105.8310170173645
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The average values of the proportion of correct responses to cross-validation for each of the 10 parameters `C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logit_mean_cv_scores2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">logit_grid_searcher2</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">logit_mean_cv_scores2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.73481117, 0.75919655, 0.76102545, 0.76082216, 0.76133023,
       0.76143192, 0.75990775, 0.75929811, 0.76000937, 0.75939977,
       0.75919661, 0.75868861, 0.757571  , 0.75736787, 0.75716462,
       0.75614861, 0.75553901, 0.75513262, 0.75401502, 0.75350692])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will output the best value of the proportion of correct answers on cross-validation and the corresponding value with.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_score2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">logit_mean_cv_scores2</span><span class="p">)</span>
<span class="n">best_C2</span> <span class="o">=</span> <span class="n">logit_grid_searcher2</span><span class="o">.</span><span class="n">Cs_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logit_mean_cv_scores2</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Score: </span><span class="si">{</span><span class="n">best_score2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best C: </span><span class="si">{</span><span class="n">best_C2</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Best Score: 0.761431920171076
Best C: 1.9157894736842107
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's draw a graph of the dependence of the proportion of correct answers to cross-validation on `C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">logit_c_values2</span><span class="p">,</span> <span class="n">logit_mean_cv_scores2</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We output the proportion of correct answers in the sample <code>(X_value, y_value)' for logistic regression with the best values found</code>C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">logit</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">best_C2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">logit_cv_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">logit_y_pred</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="n">logit_val_score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">logit_y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Time elapsed:  9.804409980773926
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 3. </font>Let's calculate the proportions of correct answers for 'logit_grid_searcher 2' on cross-validation for the best value of parameter 'C` and on deferred sampling. Round each one to 3 decimal places and print it separated by a space.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LogReg Cross-Validation Score: </span><span class="si">{</span><span class="n">logit_cv_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LogReg Validation Score: </span><span class="si">{</span><span class="n">logit_val_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LogReg Cross-Validation Score: 0.762
LogReg Validation Score: 0.782
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>4. Let's train a linear SVM ('LinearSVC<code>) with the parameter 'C'=1 and 'random_state'=17 (for reproducibility). Let's look at the proportion of correct answers on cross-validation (using the</code>skf' object created earlier) and on the sample <code>(X_valid, y_valid)</code>.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">svm</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">scores_svm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"CV scores:"</span><span class="p">,</span> <span class="n">scores_svm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"mean:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"std:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CV scores: [0.75068577 0.73270344 0.7695122 ]
mean: 0.7509671352428245
std: 0.015028426724668621
Time elapsed:  3.3960418701171875
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">svm_pred</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7769613652524295
Time elapsed:  2.0046310424804688
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Using <code>GridSearchCV</code>, we will select the parameter <code>C</code> for SVM first in a wide range: 10 values from 1e-4 to 1 e4, use <code>linspace</code> from NumPy. Let's draw validation curves.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">svm_params1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"C"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">svm_grid_searcher1</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svm</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">svm_params1</span><span class="p">,</span>
                                  <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">svm_grid_searcher1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 49.9 s, sys: 34.8 ms, total: 50 s
Wall time: 49.7 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">svm_params1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}</span>

<span class="n">svm_grid_searcher1</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">svm_params1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">svm_grid_searcher1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Time elapsed:  44.00320863723755
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will output the best value of the proportion of correct answers on cross-validation and the corresponding value <code>C</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">svm_grid_searcher1</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'C': 5555.555600000001}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's draw a graph of the dependence of the proportion of correct answers to cross-validation on <code>C</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_validation_curves</span><span class="p">(</span><span class="n">svm_params1</span><span class="p">[</span><span class="s1">'C'</span><span class="p">],</span> <span class="n">svm_grid_searcher1</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>But we remember that with the default regularization parameter (C=1) on cross-validation, the proportion of correct answers is higher. This is the case (not uncommon) when you can make a mistake and iterate over the parameters in the wrong range (the reason is that we took a uniform grid over a large interval and missed a really good range of values <code>C</code>). Here it is much more meaningful to select <code>C</code> in the region of 1, besides, this way the model learns faster than with large <code>C</code>.</p>
</blockquote>
<p><strong>Using <code>GridSearchCV</code>, we will select the parameter <code>C</code> for SVM in the range (1e-3, 1), 30 values using `linspace' from NumPy. Let's draw validation curves.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">svm_params2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'C'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)}</span>

<span class="n">svm_grid_searcher2</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">svm_params2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1.77 s, sys: 150 ms, total: 1.92 s
Wall time: 1min 18s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Output the best value of the proportion of correct answers on cross-validation and the corresponding value of <code>C</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_score</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_score_</span>
<span class="n">best_params</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_params_</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Score: </span><span class="si">{</span><span class="n">best_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Params: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Best Score: 0.7670206386611259
Best Params: {'C': 0.10434482758620689}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's draw a graph of the dependence of the proportion of correct answers to cross-validation on 'C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_validation_curves</span><span class="p">(</span><span class="n">svm_params2</span><span class="p">[</span><span class="s1">'C'</span><span class="p">],</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Output the proportion of correct answers in the sample <code>(X_value, y_value)' for 'LinearSVC</code> with the best values found `C'.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">svm</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="o">**</span><span class="n">best_params</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">svm_cv_score</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">svm_y_pred</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="n">svm_val_score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">svm_y_pred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 683 ms, sys: 8.26 ms, total: 691 ms
Wall time: 1.74 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 4. </font> Let's calculate the proportions of correct answers for 'stm_grid_searcher 2' on cross-validation for the best value of parameter 'C` and on deferred sampling. Round each one to 3 decimal places and print it separated by a space.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Cross-Validation Score: </span><span class="si">{</span><span class="n">svm_cv_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Validation Score: </span><span class="si">{</span><span class="n">svm_val_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SVC Cross-Validation Score: 0.767
SVC Validation Score: 0.781
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2.-Selection-of-parameters---session-length-and-window-width">
<a class="anchor" href="#Part-2.-Selection-of-parameters---session-length-and-window-width" aria-hidden="true"><span class="octicon octicon-link"></span></a>Part 2. Selection of parameters - session length and window width<a class="anchor-link" href="#Part-2.-Selection-of-parameters---session-length-and-window-width"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's take <code>LinearSVC</code>, which showed the best quality on cross-validation in part 1, and check its work on 8 more samples for 10 users (with different combinations of parameters <em>session_length</em> and <em>window_size</em>). Since there are already more calculations here, we will not re-select the regularization parameter <code>C</code> every time.</strong></p>
<p><strong>Let's define the <code>model_assessment</code> function, the documentation of which is described below. The split of the sample with 'train_test_split' should be stratified.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model_assessment</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">path_to_X_pickle</span><span class="p">,</span> <span class="n">path_to_y_pickle</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Estimates CV-accuracy for (1 - test_size) share of (X_sparse, y) </span>
<span class="sd">    loaded from path_to_X_pickle and path_to_y_pickle and holdout accuracy for (test_size) share of (X_sparse, y).</span>
<span class="sd">    The split is made with stratified train_test_split with params random_state and test_size.</span>
<span class="sd">    </span>
<span class="sd">    :param estimator – Scikit-learn estimator (classifier or regressor)</span>
<span class="sd">    :param path_to_X_pickle – path to pickled sparse X (instances and their features)</span>
<span class="sd">    :param path_to_y_pickle – path to pickled y (responses)</span>
<span class="sd">    :param cv – cross-validation as in cross_val_score (use StratifiedKFold here)</span>
<span class="sd">    :param random_state –  for train_test_split</span>
<span class="sd">    :param test_size –  for train_test_split</span>
<span class="sd">    </span>
<span class="sd">    :returns mean CV-accuracy for (X_train, y_train) and accuracy for (X_valid, y_valid) where (X_train, y_train)</span>
<span class="sd">    and (X_valid, y_valid) are (1 - test_size) and (testsize) shares of (X_sparse, y).</span>
<span class="sd">    '''</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_X_pickle</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">X_sparse_10users_pkl</span><span class="p">:</span>
        <span class="n">X_sparse_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">X_sparse_10users_pkl</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_y_pickle</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">y_10users_pkl</span><span class="p">:</span>
        <span class="n">y_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">y_10users_pkl</span><span class="p">)</span>
        
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sparse_10users</span><span class="p">,</span> <span class="n">y_10users</span><span class="p">,</span> 
                                                      <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                     <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_10users</span><span class="p">)</span>
    
    <span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">scores_svm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">svm_pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores_svm</span><span class="p">),</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">),</span> <span class="s2">" Time elapsed: "</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t_start</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's make sure that the function works.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_assessment</span><span class="p">(</span><span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> 
                 <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s1">'X_sparse_10users.pkl'</span><span class="p">),</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s1">'y_10users.pkl'</span><span class="p">),</span> <span class="n">skf</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.7670206386611259, 0.7807537331121118, ' Time elapsed: ', 0.6428191661834717)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's use the <em>model_assessment</em> function for the best algorithm from the previous part (namely, 'svm_grid_searcher 2.best<em>estimator</em>`) and 9 samples of the form with different combinations of parameters <em>session_length</em> and <em>window_size</em> for 10 users. We will output the <em>session_length</em> and <em>window_size</em> parameters in the loop, as well as the output result of the <em>model_assessment</em> function.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, for convenience, it is worth creating copies of previously created pickle files X_sparse_10users.pkl, X_sparse_150users.pkl, y_10users.pkl and y_150users.pkl, adding s10_w10 to their names, which means the session length is 10 and the window width is 10.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cp <span class="nv">$PATH_TO_DATA</span>/X_sparse_10users.pkl <span class="nv">$PATH_TO_DATA</span>/X_sparse_10users_s10_w10.pkl 
<span class="o">!</span>cp <span class="nv">$PATH_TO_DATA</span>/X_sparse_150users.pkl <span class="nv">$PATH_TO_DATA</span>/X_sparse_150users_s10_w10.pkl 
<span class="o">!</span>cp <span class="nv">$PATH_TO_DATA</span>/y_10users.pkl <span class="nv">$PATH_TO_DATA</span>/y_10users_s10_w10.pkl 
<span class="o">!</span>cp <span class="nv">$PATH_TO_DATA</span>/y_150users.pkl <span class="nv">$PATH_TO_DATA</span>/y_150users_s10_w10.pkl 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="k">for</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">window_size</span> <span class="o">&lt;=</span> <span class="n">session_length</span><span class="p">:</span>
        <span class="n">path_to_X_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"X_sparse_10users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
        <span class="n">path_to_y_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"y_10users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span><span class="p">,</span> 
              <span class="n">model_assessment</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> 
                               <span class="n">path_to_X_pickle</span><span class="o">=</span><span class="n">path_to_X_pkl</span><span class="p">,</span>
                               <span class="n">path_to_y_pickle</span><span class="o">=</span><span class="n">path_to_y_pkl</span><span class="p">,</span>
                               <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10 15 (0.8243252292702751, 0.8404835269021095, ' Time elapsed: ', 1.0584142208099365)
10 10 (0.7670206386611259, 0.7807537331121118, ' Time elapsed: ', 0.6238193511962891)
7 15 (0.8495024256089474, 0.8543222166915547, ' Time elapsed: ', 1.623363971710205)
7 10 (0.7983645917156946, 0.8073668491786958, ' Time elapsed: ', 0.974440336227417)
7 7 (0.754765400423003, 0.7617388418782147, ' Time elapsed: ', 0.5486903190612793)
5 15 (0.8670355547005402, 0.8752963489805595, ' Time elapsed: ', 2.1419732570648193)
5 10 (0.8177520250854086, 0.8245614035087719, ' Time elapsed: ', 1.218752145767212)
5 7 (0.772939529035208, 0.7853247984826932, ' Time elapsed: ', 0.761998176574707)
5 5 (0.7254849424351582, 0.7362494073020389, ' Time elapsed: ', 0.501572847366333)
CPU times: user 11.2 s, sys: 107 ms, total: 11.3 s
Wall time: 33.2 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="k">for</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">window_size</span> <span class="o">&lt;=</span> <span class="n">session_length</span><span class="p">:</span>
        <span class="n">path_to_X_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"X_sparse_150users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
        <span class="n">path_to_y_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"y_150users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span><span class="p">,</span> 
              <span class="n">model_assessment</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> 
                               <span class="n">path_to_X_pickle</span><span class="o">=</span><span class="n">path_to_X_pkl</span><span class="p">,</span>
                               <span class="n">path_to_y_pickle</span><span class="o">=</span><span class="n">path_to_y_pkl</span><span class="p">,</span>
                               <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10 15 (0.5488098589346596, 0.5751471804602735, ' Time elapsed: ', 223.8541784286499)
10 10 (0.46308633866107823, 0.4836276942538802, ' Time elapsed: ', 136.27440857887268)
7 15 (0.5828479247872232, 0.6084920121265797, ' Time elapsed: ', 309.6582760810852)
7 10 (0.5015547672228792, 0.5239295568348264, ' Time elapsed: ', 213.65414190292358)
7 7 (0.43694798464211154, 0.45307763054808053, ' Time elapsed: ', 149.04103302955627)
5 15 (0.6139887051608968, 0.6360295906945053, ' Time elapsed: ', 467.08626675605774)
5 10 (0.5265866745928696, 0.5458826106000876, ' Time elapsed: ', 317.86096453666687)
5 7 (0.46509602699080665, 0.48189516717769015, ' Time elapsed: ', 195.35350489616394)
5 5 (0.4084080325808655, 0.4217282328320436, ' Time elapsed: ', 142.6359510421753)
CPU times: user 36min 40s, sys: 7.97 s, total: 36min 48s
Wall time: 1h 29min 29s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 5. </font> Let's calculate the proportion of correct answers for <code>LinearSVC</code> with the configured parameter <code>C</code> and the selection <code>X_sparse_10 users_s15_w5</code>. We will indicate the proportions of correct answers on cross-validation and on deferred sampling. Round each one to 3 decimal places and print it separated by a space.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="n">path_to_X_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s2">"X_sparse_10users_s15_w5.pkl"</span><span class="p">)</span>
<span class="n">path_to_y_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s2">"y_10users_s15_w5.pkl"</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_X_pkl</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">X_sparse_10users_pkl</span><span class="p">:</span>
  <span class="n">X_sparse_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">X_sparse_10users_pkl</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_y_pkl</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">y_10users_pkl</span><span class="p">:</span>
  <span class="n">y_10users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">y_10users_pkl</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sparse_10users</span><span class="p">,</span> <span class="n">y_10users</span><span class="p">,</span> 
                                                  <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_10users</span><span class="p">)</span>

<span class="n">scores_svm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">svm_pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Cross-Validation Score: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores_svm</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Validation Score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SVC Cross-Validation Score: 0.867
SVC Validation Score: 0.875
CPU times: user 2.39 s, sys: 25.6 ms, total: 2.41 s
Wall time: 6.38 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Make a conclusion about how the quality of classification depends on the length of the session and the width of the window.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="k">for</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]:</span>
    <span class="n">path_to_X_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"X_sparse_150users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
    <span class="n">path_to_y_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"y_150users_s</span><span class="si">{</span><span class="n">session_length</span><span class="si">}</span><span class="s2">_w</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.pkl"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="n">session_length</span><span class="p">,</span> 
          <span class="n">model_assessment</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> 
                           <span class="n">path_to_X_pickle</span><span class="o">=</span><span class="n">path_to_X_pkl</span><span class="p">,</span>
                           <span class="n">path_to_y_pickle</span><span class="o">=</span><span class="n">path_to_y_pkl</span><span class="p">,</span>
                           <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5 5 (0.4084080325808655, 0.4217282328320436, ' Time elapsed: ', 133.36306834220886)
7 7 (0.43694798464211154, 0.45307763054808053, ' Time elapsed: ', 120.4077639579773)
10 10 (0.46308633866107823, 0.4836276942538802, ' Time elapsed: ', 114.10968589782715)
CPU times: user 6min 16s, sys: 1.8 s, total: 6min 17s
Wall time: 16min 33s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 6. </font> Calculate the proportions of correct answers for <code>LinearSVC</code> with the <code>C' parameter configured and the</code>X_sparse_150 users` selection. Specify the proportions of correct answers on cross-validation and on deferred sampling. Round each one to 3 decimal places and separate it with a space.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="n">path_to_X_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s2">"X_sparse_150users.pkl"</span><span class="p">)</span>
<span class="n">path_to_y_pkl</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s2">"y_150users.pkl"</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_X_pkl</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">X_sparse_150users_pkl</span><span class="p">:</span>
  <span class="n">X_sparse_150users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">X_sparse_150users_pkl</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_y_pkl</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">y_150users_pkl</span><span class="p">:</span>
  <span class="n">y_150users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">y_150users_pkl</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sparse_150users</span><span class="p">,</span> <span class="n">y_150users</span><span class="p">,</span> 
                                                  <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_150users</span><span class="p">)</span>

<span class="n">scores_svm</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">svm_pred</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Cross-Validation Score: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores_svm</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SVC Validation Score: </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SVC Cross-Validation Score: 0.463
SVC Validation Score: 0.484
CPU times: user 1min 46s, sys: 339 ms, total: 1min 47s
Wall time: 4min 37s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-3.-Identification-of-a-specific-user-and-learning-curves">
<a class="anchor" href="#Part-3.-Identification-of-a-specific-user-and-learning-curves" aria-hidden="true"><span class="octicon octicon-link"></span></a>Part 3. Identification of a specific user and learning curves<a class="anchor-link" href="#Part-3.-Identification-of-a-specific-user-and-learning-curves"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Since it may be disappointing that the multiclass share of correct answers in a sample of 150 users is small, let's be glad that a particular user can be identified well enough.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's load the previously serialized objects <em>X_sparse_150users</em> and <em>y_150users</em> corresponding to the training sample for 150 users with parameters (<em>session_length, window_size</em>) = (10.10). Just exactly break them down into 70% and 30%.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s1">'X_sparse_150users.pkl'</span><span class="p">),</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">X_sparse_150users_pkl</span><span class="p">:</span>
     <span class="n">X_sparse_150users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">X_sparse_150users_pkl</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH_TO_DATA</span><span class="p">,</span> <span class="s1">'y_150users.pkl'</span><span class="p">),</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">y_150users_pkl</span><span class="p">:</span>
    <span class="n">y_150users</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">y_150users_pkl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train_150</span><span class="p">,</span> <span class="n">X_valid_150</span><span class="p">,</span> <span class="n">y_train_150</span><span class="p">,</span> <span class="n">y_valid_150</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_sparse_150users</span><span class="p">,</span> 
                                                                      <span class="n">y_150users</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                     <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_150users</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's train <code>LogisticRegressionCV</code> for one value of the parameter <code>C</code> (the best on cross-validation in 1 part, use the exact value, not by eye). Now we will solve 150 tasks "One-against-All", so we will specify the argument <code>multi_class</code>=<code>ovr</code>. As always, where possible, specify <code>n_jobs=-1</code> and <code>random_state</code>=17.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">LogisticRegressionCV</span>

<span class="n">best_C2_tmp</span> <span class="o">=</span> <span class="mf">1.9157894736842107</span>

<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_train_150_tmp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y_train_150</span><span class="p">:</span>
  <span class="n">y_train_150_tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">:]))</span>

<span class="c1"># convert to int</span>
<span class="n">y_train_150_work</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train_150_tmp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">logit_cv_150users</span> <span class="o">=</span> <span class="n">LogisticRegressionCV</span><span class="p">(</span><span class="n">Cs</span><span class="o">=</span><span class="p">[</span><span class="n">best_C2_tmp</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">"ovr"</span><span class="p">,</span> 
                                         <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">logit_cv_150users</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_150</span><span class="p">,</span> <span class="n">y_train_150_work</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 6min 55s, sys: 7min 30s, total: 14min 25s
Wall time: 15min 25s
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Look at the average proportions of correct responses to cross-validation in the task of identifying each user individually.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv_scores_by_user</span> <span class="o">=</span> <span class="n">logit_cv_150users</span><span class="o">.</span><span class="n">scores_</span>
<span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">logit_cv_150users</span><span class="o">.</span><span class="n">scores_</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"User </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">, CV score: </span><span class="si">{</span><span class="n">cv_scores_by_user</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>User 6, CV score: 0.996058928403866
User 13, CV score: 0.9963091551718745
User 15, CV score: 0.9952352652925046
User 16, CV score: 0.9918676300397236
User 28, CV score: 0.9903766955470061
User 31, CV score: 0.9943907499504759
User 33, CV score: 0.9937651830304546
User 39, CV score: 0.9858621876075193
User 46, CV score: 0.9980398903172666
User 49, CV score: 0.9952039869465036
User 50, CV score: 0.9943386193738076
User 53, CV score: 0.9937130524537862
User 65, CV score: 0.9969451482072295
User 66, CV score: 0.9948077945638234
User 82, CV score: 0.996361285748543
User 85, CV score: 0.9963717118638766
User 89, CV score: 0.9908667229676894
User 92, CV score: 0.994422028296477
User 100, CV score: 0.9944741588731455
User 102, CV score: 0.9911586541970326
User 103, CV score: 0.980565721018006
User 105, CV score: 0.9969034437458948
User 106, CV score: 0.9948494990251583
User 118, CV score: 0.990950131890359
User 119, CV score: 0.9965906602858841
User 120, CV score: 0.994286488797139
User 126, CV score: 0.995058021331832
User 127, CV score: 0.9915965510410477
User 128, CV score: 0.9846944626901463
User 138, CV score: 0.9970598354759
User 158, CV score: 0.9970598354759
User 160, CV score: 0.9968200348232252
User 165, CV score: 0.997362192820577
User 172, CV score: 0.9964863991325471
User 177, CV score: 0.9967783303618906
User 203, CV score: 0.9975707151272508
User 207, CV score: 0.9877805928289178
User 223, CV score: 0.9965489558245494
User 233, CV score: 0.9963091551718746
User 235, CV score: 0.9966636430932199
User 236, CV score: 0.9900117815103271
User 237, CV score: 0.9893862145903057
User 238, CV score: 0.9962570245952062
User 240, CV score: 0.9957461449438553
User 241, CV score: 0.9959650933658629
User 242, CV score: 0.9951414302545015
User 245, CV score: 0.9960067978271976
User 246, CV score: 0.9970181310145653
User 249, CV score: 0.9950058907551634
User 252, CV score: 0.9965072513632145
User 254, CV score: 0.9920135956543952
User 256, CV score: 0.9961006328652008
User 258, CV score: 0.9959338150198618
User 259, CV score: 0.9949120557171603
User 260, CV score: 0.9974038972819117
User 261, CV score: 0.9897511286269848
User 263, CV score: 0.9927955543044217
User 264, CV score: 0.9966010864012178
User 269, CV score: 0.9871341736782293
User 270, CV score: 0.9894279190516405
User 273, CV score: 0.9944011760658097
User 287, CV score: 0.9901681732403323
User 294, CV score: 0.9957461449438553
User 298, CV score: 0.9912941936963707
User 301, CV score: 0.9972058010905717
User 308, CV score: 0.9957044404825206
User 315, CV score: 0.9975498628965833
User 318, CV score: 0.9958921105585269
User 327, CV score: 0.9966427908625525
User 332, CV score: 0.9968096087078915
User 333, CV score: 0.9962674507105397
User 339, CV score: 0.9971223921679022
User 340, CV score: 0.9967157736698883
User 342, CV score: 0.99225339630707
User 344, CV score: 0.9966532169778862
User 351, CV score: 0.99245149249841
User 356, CV score: 0.9976019934732517
User 361, CV score: 0.9965802341705504
User 363, CV score: 0.9964863991325471
User 411, CV score: 0.9912212108890349
User 417, CV score: 0.9967261997852219
User 425, CV score: 0.9942239321051369
User 430, CV score: 0.9962674507105399
User 435, CV score: 0.9970389832452327
User 436, CV score: 0.9951831347158362
User 440, CV score: 0.9970389832452327
User 444, CV score: 0.9978105157799256
User 475, CV score: 0.9892506750909679
User 476, CV score: 0.9969868526685642
User 486, CV score: 0.9954125092531774
User 515, CV score: 0.9942135059898033
User 533, CV score: 0.9937964613764558
User 561, CV score: 0.9845276448448073
User 563, CV score: 0.9968304609385589
User 564, CV score: 0.9956835882518532
User 568, CV score: 0.991784221117054
User 569, CV score: 0.9893028056676362
User 570, CV score: 0.9982901170852752
User 573, CV score: 0.9907624618143527
User 575, CV score: 0.9900534859716618
User 576, CV score: 0.9941613754131349
User 580, CV score: 0.9867484074108828
User 583, CV score: 0.9808368000166817
User 584, CV score: 0.9811912879380271
User 600, CV score: 0.9915756988103803
User 603, CV score: 0.9957044404825206
User 605, CV score: 0.9975290106659159
User 640, CV score: 0.9972579316672402
User 647, CV score: 0.9976436979345866
User 653, CV score: 0.9973830450512443
User 664, CV score: 0.9952144130618373
User 665, CV score: 0.9969138698612284
User 677, CV score: 0.9966323647472187
User 692, CV score: 0.9969347220918957
User 697, CV score: 0.9959963717118638
User 705, CV score: 0.9964342685558788
User 722, CV score: 0.9947035334104865
User 740, CV score: 0.996694921439221
User 741, CV score: 0.9968513131692264
User 756, CV score: 0.9955793270985164
User 780, CV score: 0.9965489558245494
User 784, CV score: 0.9966532169778862
User 785, CV score: 0.9969555743225631
User 797, CV score: 0.995756571059189
User 812, CV score: 0.9949224818324941
User 844, CV score: 0.9970285571298989
User 859, CV score: 0.9981337253552699
User 868, CV score: 0.9965489558245494
User 875, CV score: 0.9957148665978544
User 932, CV score: 0.990512235046344
User 996, CV score: 0.9933168600711061
User 1014, CV score: 0.9971328182832359
User 1040, CV score: 0.9970389832452327
User 1054, CV score: 0.9964655469018799
User 1248, CV score: 0.9977375329725898
User 1267, CV score: 0.9973309144745759
User 1299, CV score: 0.996924295976562
User 1371, CV score: 0.9934419734551104
User 1797, CV score: 0.994891203486493
User 1798, CV score: 0.9966740692085535
User 1993, CV score: 0.9967991825925578
User 2118, CV score: 0.9978522202412603
User 2174, CV score: 0.995860832212526
User 2191, CV score: 0.9952665436385058
User 2250, CV score: 0.9973413405899096
User 2355, CV score: 0.995860832212526
User 2408, CV score: 0.9937547569151209
User 2493, CV score: 0.9966115125165516
User 2625, CV score: 0.9961423373265355
User 2902, CV score: 0.9971223921679022
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>The results seem impressive, but perhaps we forget about the imbalance of classes, and a high proportion of correct answers can be obtained by constant prediction. Let's calculate for each user the difference between the proportion of correct answers to cross-validation (just calculated using LogisticRegressionCV) and the proportion of labels in y_train_150 other than the ID of this user (this is the proportion of correct answers that can be obtained if the classifier always "says" that this is not the user with the number i in the classification task i-vs-All).</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">class_distr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">y_train_150_work</span><span class="p">)</span>
<span class="n">acc_diff_vs_constant</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train_150_work</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">class_distr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">class_distr</span><span class="p">[</span><span class="n">user_id</span><span class="p">])</span> <span class="o">/</span> <span class="n">class_distr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">cv_scores_by_user</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">val</span>
    <span class="n">acc_diff_vs_constant</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"User: </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2"> Val: </span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> Diff: </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>6
User: 6 Val: 0.984 Diff: 0.011656396943062974
13
User: 13 Val: 0.996 Diff: 0.000604714689353858
15
User: 15 Val: 0.994 Diff: 0.0008340892266949229
16
User: 16 Val: 0.985 Diff: 0.007152315118909902
28
User: 28 Val: 0.988 Diff: 0.0024292848727492933
31
User: 31 Val: 0.994 Diff: -6.255669200216918e-05
33
User: 33 Val: 0.993 Diff: 0.0012198554940413553
39
User: 39 Val: 0.984 Diff: 0.0019496835673996626
46
User: 46 Val: 0.997 Diff: 0.0009174981493643708
49
User: 49 Val: 0.994 Diff: 0.0013762472240467227
50
User: 50 Val: 0.994 Diff: 0.00018767007600650754
53
User: 53 Val: 0.992 Diff: 0.0016681784533899569
65
User: 65 Val: 0.997 Diff: 2.0852230667389726e-05
66
User: 66 Val: 0.995 Diff: -5.213057666852983e-05
82
User: 82 Val: 0.996 Diff: 1.0426115333750374e-05
85
User: 85 Val: 0.996 Diff: 0.00017724396067264614
89
User: 89 Val: 0.990 Diff: 0.0007923847653602545
92
User: 92 Val: 0.994 Diff: 0.0002710789986758444
100
User: 100 Val: 0.995 Diff: -0.0002710789986758444
102
User: 102 Val: 0.990 Diff: 0.0007194019580243349
103
User: 103 Val: 0.977 Diff: 0.0035657314441213117
105
User: 105 Val: 0.996 Diff: 0.0008862198033635638
106
User: 106 Val: 0.987 Diff: 0.007631916424259533
118
User: 118 Val: 0.990 Diff: 0.0009487764953656219
119
User: 119 Val: 0.996 Diff: 0.0006464191506886374
120
User: 120 Val: 0.994 Diff: 0.0006255669200211367
126
User: 126 Val: 0.994 Diff: 0.0010009070720340407
127
User: 127 Val: 0.988 Diff: 0.004087037210805722
128
User: 128 Val: 0.980 Diff: 0.005098370398173291
138
User: 138 Val: 0.997 Diff: -5.2130576668418804e-05
158
User: 158 Val: 0.997 Diff: 0.00028150511400959477
160
User: 160 Val: 0.997 Diff: 0.00028150511400959477
165
User: 165 Val: 0.997 Diff: 0.00028150511400959477
172
User: 172 Val: 0.996 Diff: 0.00022937453734106494
177
User: 177 Val: 0.996 Diff: 0.0002815051140097058
203
User: 203 Val: 0.996 Diff: 0.0013866733393805841
207
User: 207 Val: 0.986 Diff: 0.0014179516853815022
223
User: 223 Val: 0.996 Diff: 8.34089226695589e-05
233
User: 233 Val: 0.996 Diff: 7.298280733591955e-05
235
User: 235 Val: 0.997 Diff: -8.34089226695589e-05
236
User: 236 Val: 0.989 Diff: 0.0012302816093752167
237
User: 237 Val: 0.988 Diff: 0.0013762472240467227
238
User: 238 Val: 0.996 Diff: -1.0426115333639352e-05
240
User: 240 Val: 0.996 Diff: -3.12783460011401e-05
241
User: 241 Val: 0.996 Diff: -0.0001355394993378667
242
User: 242 Val: 0.995 Diff: 0.00047960130534974166
245
User: 245 Val: 0.996 Diff: 0.00023980065267481532
246
User: 246 Val: 0.997 Diff: -0.00010426115333694863
249
User: 249 Val: 0.995 Diff: -9.383503800330928e-05
252
User: 252 Val: 0.996 Diff: 0.00020852230667367522
254
User: 254 Val: 0.990 Diff: 0.0020956491820712797
256
User: 256 Val: 0.996 Diff: 0.0005421579973517998
258
User: 258 Val: 0.996 Diff: 0.00017724396067275716
259
User: 259 Val: 0.995 Diff: -0.0002710789986758444
260
User: 260 Val: 0.997 Diff: 0.0003232095753442632
261
User: 261 Val: 0.989 Diff: 0.0006464191506885264
263
User: 263 Val: 0.992 Diff: 0.0011990032633740766
264
User: 264 Val: 0.996 Diff: 0.00039619238268018275
269
User: 269 Val: 0.986 Diff: 0.0013866733393805841
270
User: 270 Val: 0.985 Diff: 0.004305985632813036
273
User: 273 Val: 0.994 Diff: 0.0006672713813560271
287
User: 287 Val: 0.988 Diff: 0.001928831336732162
294
User: 294 Val: 0.996 Diff: -0.00020852230667389726
298
User: 298 Val: 0.990 Diff: 0.0015222128387184508
301
User: 301 Val: 0.995 Diff: 0.001730735145392126
308
User: 308 Val: 0.995 Diff: 0.0007298280733580853
315
User: 315 Val: 0.997 Diff: 0.0004378968440148512
318
User: 318 Val: 0.995 Diff: 0.0005525841126853281
327
User: 327 Val: 0.997 Diff: 1.0426115333639352e-05
332
User: 332 Val: 0.997 Diff: -1.0426115333750374e-05
333
User: 333 Val: 0.995 Diff: 0.0012928383013771638
339
User: 339 Val: 0.996 Diff: 0.0011990032633741876
340
User: 340 Val: 0.997 Diff: 0.00020852230667367522
342
User: 342 Val: 0.992 Diff: 0.00034406180601176395
344
User: 344 Val: 0.997 Diff: -0.00012511338400422733
351
User: 351 Val: 0.991 Diff: 0.0014179516853815022
356
User: 356 Val: 0.997 Diff: 0.0003857662673464324
361
User: 361 Val: 0.997 Diff: -5.2130576668418804e-05
363
User: 363 Val: 0.995 Diff: 0.0011885771480403262
411
User: 411 Val: 0.989 Diff: 0.001991388028734442
417
User: 417 Val: 0.997 Diff: 9.383503800308723e-05
425
User: 425 Val: 0.994 Diff: 6.255669200205816e-05
430
User: 430 Val: 0.995 Diff: 0.0010217593027015415
435
User: 435 Val: 0.997 Diff: -0.00011468726867058798
436
User: 436 Val: 0.995 Diff: 0.0001668178453390068
440
User: 440 Val: 0.997 Diff: -5.2130576668418804e-05
444
User: 444 Val: 0.997 Diff: 0.0007923847653603655
475
User: 475 Val: 0.988 Diff: 0.0012615599553762458
476
User: 476 Val: 0.996 Diff: 0.0008549414573624237
486
User: 486 Val: 0.995 Diff: 0.0001668178453390068
515
User: 515 Val: 0.994 Diff: 0.00022937453734117597
533
User: 533 Val: 0.993 Diff: 0.0011572988020394082
561
User: 561 Val: 0.981 Diff: 0.0035553053287875613
563
User: 563 Val: 0.996 Diff: 0.0005213057666844101
564
User: 564 Val: 0.995 Diff: 0.0005525841126854392
568
User: 568 Val: 0.992 Diff: -4.170446133477945e-05
569
User: 569 Val: 0.985 Diff: 0.0042538550561445065
570
User: 570 Val: 0.996 Diff: 0.0025856766027545497
573
User: 573 Val: 0.991 Diff: -0.00019809619133992484
575
User: 575 Val: 0.989 Diff: 0.0014492300313825313
576
User: 576 Val: 0.994 Diff: -0.00022937453734106494
580
User: 580 Val: 0.980 Diff: 0.006266095315546338
583
User: 583 Val: 0.966 Diff: 0.014794657658502963
584
User: 584 Val: 0.978 Diff: 0.0027524944480935565
600
User: 600 Val: 0.991 Diff: 0.000980054841366762
603
User: 603 Val: 0.995 Diff: 0.0006464191506886374
605
User: 605 Val: 0.995 Diff: 0.0024605632187502113
640
User: 640 Val: 0.997 Diff: 0.00021894842200753661
647
User: 647 Val: 0.996 Diff: 0.0016264739920553994
653
User: 653 Val: 0.997 Diff: 0.0001355394993378667
664
User: 664 Val: 0.995 Diff: 0.0006359930353549981
665
User: 665 Val: 0.997 Diff: 0.00023980065267481532
677
User: 677 Val: 0.996 Diff: 0.0007298280733580853
692
User: 692 Val: 0.997 Diff: 6.255669200205816e-05
697
User: 697 Val: 0.995 Diff: 0.000750680304025475
705
User: 705 Val: 0.996 Diff: 0.0002502267680085657
722
User: 722 Val: 0.994 Diff: 0.0010843159947033776
740
User: 740 Val: 0.996 Diff: 0.0008340892266950339
741
User: 741 Val: 0.997 Diff: 7.298280733591955e-05
756
User: 756 Val: 0.995 Diff: 0.0002710789986758444
780
User: 780 Val: 0.996 Diff: 0.0007819586500266151
784
User: 784 Val: 0.995 Diff: 0.001699456799391097
785
User: 785 Val: 0.997 Diff: -8.34089226695589e-05
797
User: 797 Val: 0.995 Diff: 0.0005421579973516888
812
User: 812 Val: 0.990 Diff: 0.005421579973517776
844
User: 844 Val: 0.997 Diff: 6.255669200205816e-05
859
User: 859 Val: 0.997 Diff: 0.0012198554940414663
868
User: 868 Val: 0.997 Diff: -0.00022937453734106494
875
User: 875 Val: 0.990 Diff: 0.0055779717035230325
932
User: 932 Val: 0.988 Diff: 0.0024084326420817925
996
User: 996 Val: 0.990 Diff: 0.0028359033707631154
1014
User: 1014 Val: 0.996 Diff: 0.0013449688780456936
1040
User: 1040 Val: 0.995 Diff: 0.0018662746447301037
1054
User: 1054 Val: 0.996 Diff: 0.000114687268670699
1248
User: 1248 Val: 0.997 Diff: 0.00040661849801393313
1267
User: 1267 Val: 0.997 Diff: 0.0003336356906780136
1299
User: 1299 Val: 0.997 Diff: 9.383503800308723e-05
1371
User: 1371 Val: 0.989 Diff: 0.0047126041308269695
1797
User: 1797 Val: 0.992 Diff: 0.0031486868307737392
1798
User: 1798 Val: 0.995 Diff: 0.001240707724708745
1993
User: 1993 Val: 0.996 Diff: 0.0008757936880298134
2118
User: 2118 Val: 0.996 Diff: 0.0015117867233847004
2174
User: 2174 Val: 0.995 Diff: 0.0005108796513507707
2191
User: 2191 Val: 0.995 Diff: 0.0004378968440149622
2250
User: 2250 Val: 0.997 Diff: -9.383503800319826e-05
2355
User: 2355 Val: 0.987 Diff: 0.008424301189619787
2408
User: 2408 Val: 0.992 Diff: 0.0013345427627119433
2493
User: 2493 Val: 0.996 Diff: 0.0003023573446770955
2625
User: 2625 Val: 0.995 Diff: 0.0006776974966896665
2902
User: 2902 Val: 0.995 Diff: 0.00207479695140389
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_better_than_default</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">acc_diff_vs_constant</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">num_better_than_default</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>127</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Question 7. </font> Let's calculate the proportion of users for whom the logistic regression on cross-validation gives a better forecast than the constant one. Round it up to 3 decimal places.</strong>|</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">better</span> <span class="o">=</span> <span class="n">num_better_than_default</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">acc_diff_vs_constant</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">better</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.8466666666666667
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Next, we will build learning curves for a specific user, for example, for the 128th. Let's make a new binary vector based on y_150 users, its values will be 1 or 0, depending on whether the user ID is 128.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_binary_128</span> <span class="o">=</span> <span class="n">y_150users</span> <span class="o">==</span> <span class="s1">'user0128'</span>
<span class="n">y_binary_128</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"int"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0, ..., 0, 0, 0])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">learning_curve</span>

<span class="k">def</span> <span class="nf">plot_learning_curve</span><span class="p">(</span><span class="n">val_train</span><span class="p">,</span> <span class="n">val_test</span><span class="p">,</span> <span class="n">train_sizes</span><span class="p">,</span> 
                        <span class="n">xlabel</span><span class="o">=</span><span class="s1">'Training Set Size'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'score'</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">plot_with_err</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">mu</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">std</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">std</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                         <span class="n">facecolor</span><span class="o">=</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plot_with_err</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">val_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'train'</span><span class="p">)</span>
    <span class="n">plot_with_err</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">val_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'valid'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's calculate the proportions of correct answers to cross-validation in the classification problem "user128-vs-All" depending on the sample size.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">train_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">svm_grid_searcher2</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="n">n_train</span><span class="p">,</span> <span class="n">val_train</span><span class="p">,</span> <span class="n">val_test</span> <span class="o">=</span> <span class="n">learning_curve</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X_sparse_150users</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y_binary_128</span><span class="p">,</span>
    <span class="n">train_sizes</span><span class="o">=</span><span class="n">train_sizes</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 630 ms, sys: 148 ms, total: 777 ms
Wall time: 20.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">val_train</span><span class="p">,</span> <span class="n">val_test</span><span class="p">,</span> <span class="n">n_train</span><span class="p">,</span> 
                    <span class="n">xlabel</span><span class="o">=</span><span class="s1">'train_size'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ways-to-improve">
<a class="anchor" href="#Ways-to-improve" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ways to improve<a class="anchor-link" href="#Ways-to-improve"> </a>
</h2>
<ul>
<li>of course, you can check a bunch of algorithms, for example, Xgboost, but in such a task it is very unlikely that something will do better than linear methods</li>
<li>it is interesting to check the quality of the algorithm on data where sessions were distinguished not by the number of sites visited, but by time, for example, 5, 7, 10 and 15 minutes. Separately, it is worth noting the data of our <a href="http://inclass.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking2">соревнования</a>
</li>
<li>again, if the resources allow, you can check how well you can solve the problem for 3000 users</li>
</ul>
<p>Next week we will remember about linear models trained by stochastic gradient descent, and we will rejoice at how much faster they work. We will also make the first (or not the first) in the parcels [competition] (<a href="https://in">https://in</a> class.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking2 ) Kaggle class.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Zmey56/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/graduation%20project/machine%20learning/stepik/yandex/english/2019/08/09/project-identification-of-internet-users-week4.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Zmey56" target="_blank" title="Zmey56"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/Zmey56" target="_blank" title="Zmey56"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
